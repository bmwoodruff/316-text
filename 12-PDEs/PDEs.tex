
\chapter{Partial Differential Equations}

This chapter covers the following ideas. When you create your lesson plan, it should contain examples which illustrate these key ideas. Before you take the quiz on this unit, meet with another student out of class and teach each other from the examples on your lesson plan. 

\input{12-PDEs/PDEs-objectives}


\section{Basic Definitions}
A PDE is an equation involving a function $u$ and its independent variables. Some examples are $u_{tt}=c^2u_{xx}$ (the one dimensional wave equation), $u_t = c^2u_{xx}$, $u_{xx}+u_{yy}=0$, etc. Partial differential equations appear often in applications.  The order of the PDE is the highest partial derivative of $u$ which appears in the equation.  The PDE is said to be linear if $u$ and its partial derivatives appear no more than once in each term.  The PDE $u_t+u_{xx}-u=0$ is linear, whereas $u_t u-u_{xx}=0$ is not.  A PDE is said to be homogeneous if each term contains either $u$ or a partial derivative.

A solution of a PDE on some region $R$ is a function $u$ defined on an open region containing $R$ which satisfies the PDE everywhere on $R$.  The key thing is that a solution is a function of multiple variables. If a linear PDE is homogeneous, then the superposition principle applies, which means that the sum of two solutions to a linear homogeneous PDE is again a solution.  The functions $u(x,y) = x^2-y^2,u(x,y)= \arctan(y/x),u(x,y)=e^x\cos y, u(x,y)=\ln(x^2+y^2)$ are all solutions of the PDE $u_{xx}+u_{yy}=0$ which is called Laplace's equation.  You can verify this yourself by differentiating. Hence any linear combination of these four solutions is also a solution. Notice however that $u(x,y)= \arctan(y/x)$ is only a solution on a region $R$ in the $xy$ plane which does not contain the $y$-axis, as the function is not defined at $x=0$.  Similarly $u(x,y)=\ln(x^2+y^2)$ is only a solution on regions which do not contain the origin (0,0).

Some PDEs can be solved by ODE methods.  The PDE $u_{xy}=3u_x$ can be solved as follows.  If we let $u_x = p$, then we have $p_y=3p$. A solution is $p=Ce^{3y}$, where $C$ is a constant with respect to $y$.  That means that $C$ could be any function of $x$.  Hence we have $u_x = p = C(x)e^{3y}$.  Integration with respect to $x$ gives $u(x,y) = \int C(x)dx e^{3y}+D(y)$, where the constant $D$ could be a function of $y$.  As another example, $u_{yy}-u=0$ does not involve any derivatives with respect to $x$.  A solution using ODE techniques is $u = A\cos y +B\sin y$.  However $A$ and $B$  are constants with respect to $y$, which means they could be any functions of $x$.  A solution in general is thus $u(x,y) = A(x)\cos y +B(x)\sin y$ where $A(x),B(x)$ are any functions of $x$.  We will use this basic idea in the homework to review solution techniques for every type of ODE.

\section{Derivation of the one dimensional wave equation}
We now derive the one dimensional wave equation $u_{tt}=c^2u_{xx}$.  This PDE models the motion of a vibrating string of length $L$ which is fixed at two endpoints.  The function $u(t,x)$ will give the vertical position of a vibrating string at any $t$ for any $x$ along the string.  We require that the string is fixed at $u(t,0)=u(t,L) = 0$ for all time (these two conditions are called boundary conditions). In order to know the position of the string for all time, we need to know its initial position $u(0,x) = f(x)$ and initial velocity $u_t(0,x)=g(x)$ for all $x$.  The boundary and initial conditions should give us enough information to find the position for all $t,x$.  We now make three simplifying assumptions so that we can model the motion of a vibrating string using PDEs. (1) The density of the string is constant and the string is perfectly elastic. (2) The tension in the string created by the attachment at the endpoints is so strong that the force due to gravity can be neglected. (3) Motion is always perpendicular to the segment connecting the endpoints, so that the bit of string $x$ units away from the left endpoint will  only move vertically, never horizontally.

Pick two points at distances $x$ and $x+\Delta x$ away from the left endpoint. Since motion is always vertical, the horizontal components of tension in both directions are the same in magnitude throughout the entire wire. Call this magnitude $T$. Let $\vec T_1$ be the tension pulling the string at $x$ toward the left endpoint and $\vec T_2$ the tension pulling the string at $x+\Delta x$ toward the right endpoint. Let $\alpha$ be the acute angle between $\vec T_1$ and the horizontal, so that the horizontal component of the tension is $|T_1|\cos\alpha$. Similarly let  $\beta$   be the acute angle between $\vec T_2$ and the horizontal, so that the horizontal component of the tension is $|T_2|\cos\beta$.  This means $T=|T_1|\cos\alpha=|T_2|\cos\beta$.  Now Newton's second law of motion says that $F=ma$.  The vertical components of force acting on the segment of string between $x$ and $x+\Delta x$ are approximately $-|T_1|\sin\alpha +|T_2|\sin\beta$, which by Newton's second law is the mass $\rho \Delta x$ (where $\rho$ is the density per unit length) times the acceleration $u_{tt}$ at some point between $x$ and $x+\Delta x$.  We have the equation  $|T_2|\sin\beta-|T_1|\sin\alpha = \rho \Delta x u_{tt}$.  Divide both sides by $T=|T_1|\cos\alpha=|T_2|\cos\beta$, giving the equation $\tan\beta-\tan\alpha = \frac{\rho \Delta x}{T} u_{tt}$.  Recall that $\tan\alpha$ is the slope of the curve at $x$, which equals $u_x\big|_{x=x}$. Similarly $\tan\beta=u_x\big|_{x=x+\Delta x}$. Division by $\Delta x$ gives the equation $\frac{1}{\Delta x}(u_x\big|_{x=x+\Delta x} -u_x\big|_{x=x} ) = \frac{\rho }{T} u_{tt}$.  The limit as $\Delta x\to 0$ of the quantity on the left is precisely the definition of the partial derivative of $u_x$ with respect to $x$.  Hence taking limits gives us $u_{xx} = \frac{\rho}{T}u_{tt}$.  This is commonly written $u_{tt} = \frac{T}{\rho}u_{xx} = c^2u_{xx}$, where $c^2$ reminds us that the constant $\frac{T}{\rho}$ must be positive.


\section{Solution of the wave equation}

The following solution of the wave equation is a general technique which is useful in various places in modeling. It involves three steps: (1) separate variable, (2) solve multiple ODEs, (3) combine the solutions using superposition. Recall the boundary conditions $u(t,0)=u(t,L) = 0$ and initial conditions $u(0,x) = f(x)$, $u_t(0,x)=g(x)$ from before.  We seek a solution $u(t,x)$ of  $u_{tt}  = c^2u_{xx}$ which satisfies all of these conditions. 
\subsection{Separate Variables}
We assume that our solution satisfies $u(t,x)=G(t)F(x)$, i.e. the variables $t$ and $x$ can be separated.  If this is true, then the PDE  $u_{tt}  = c^2u_{xx}$ becomes $FG_{tt} = c^2F_{xx}G$ or $F\ddot{G}=c^2F^{\prime\prime}G$, where the dots mean derivative with respect to $t$ and the primes mean derivatives with respect to $F$. We can rewrite the equation as $\frac{\ddot{G}}{c^2G} = \frac{F^{\prime\prime}}{F}$. The left side of this equation does not change if $x$ changes, and the right side does not change if $t$ changes, which means that it must be constant, or $\frac{\ddot{G}}{c^2G} = \frac{F^{\prime\prime}}{F}=p$ for some constant $k$.  This gives us two equations $\frac{\ddot{G}}{c^2G}=k$ and $\frac{F^{\prime\prime}}{F}=k$, or $\ddot{G} = kc^2G$ and $F^{\prime\prime}=kF$,  which are both ODEs.
\subsection{Solve Multiple ODEs}
We first solve $F^{\prime\prime}=kF$, or $F^{\prime\prime}-kF=0$, and along the way show that $k<0$. The characteristic equation is $\lambda^2-k=0$.  If $k=0$, then the solution is $F(x) = ax+b$.  However the conditions $u(t,0)=u(t,L) = 0$ require that $F(0)=0=F(L)$, which means that both $a$ and $b$ are 0, or $F(x)=0$ which is a useless solution.  Similarly, if $k>0$ then the solution is $F(x) = Ae^{-\sqrt{k} x}+Be^{\sqrt k x}$.  The boundary conditions $F(0)=0=F(L)$ give the system of equations $A+B=0$ and $Ae^{-\sqrt{k} L}+Be^{\sqrt k L}=0$ which has solution $A=0=B$, which again gives the useless solution $F(x)=0$.  If $k<0$, then letting $k=-p^2$ the solution is $F(x) = A\cos(px)+B\sin(px)$.  The boundary conditions $F(0)=0=F(L)$ give $0=A$ and $0=B\sin(pL)$.  This means that $pL=n\pi$ or $p=\frac{n\pi}{L}$, as the sine function is zero at any integer multiple of $\pi$.  This means that for every integer $n$ we have a solution $F_n(x) =B\sin\frac{n\pi x}{L}$ of the first ODE. Recall also that $k=-p_n^2$ must be negative. Because it simplifies our work later on, we let $B=1$ and write $F_n(x) =\sin\frac{n\pi x}{L}$, though any multiple of $F_n$ would also be a solution.

The second ODE $\ddot{G} = kc^2G$ can be rewritten $\ddot{G} + p_n^2c^2G = 0$, or letting $\lambda_n=p_nc$ we have $\ddot{G} + \lambda_n^2G = 0$.  Solutions to this ODE are $G_n(t) = A_n\cos\lambda_n t+B_n\sin\lambda_n t$ for arbitrary constants $A_n$ and $B_n$. 
For each $n$ we thus have a solution $u_n(t,x)=G_n(t)F_n(t)$ of the original PDE.

\subsection{Combine the solutions using superposition}
The solution $u_n(t,x)=G_n(t)F_n(t)$ of the wave equation in general will not satisfy the initial conditions $u(0,x) = f(x)$, $u_t(0,x)=g(x)$.  So to find a solution which does, we add together these solutions and then solve for the constants $A_n$ and $B_n$. A finite sum of solutions will always be a solution, and the infinite sum $u(t,x) = \sum_{n=1}^\infty u_n(t,x) = \sum_{n=1}^\infty  G_n(t)F_n(t) = \sum_{n=1}^\infty (A_n\cos\lambda_n t+B_n\sin\lambda_n t) \sin\frac{n\pi x}{L} $ will be a solution under suitable convergence and differentiability conditions. Letting $t=0$ and recalling $u(0,x) = f(x)$, we now solve $f(x) = \sum_{n=1}^\infty A_n \sin\frac{n\pi x}{L} $ which is a Fourier sine series of $f(x)$.  This means that we can solve for $A_n = \frac{2}{L}\int_0^L f(x)\sin\frac{n\pi x}{L}dx$. Taking a derivative with respect to $t$ gives $\sum_{n=1}^\infty (-\lambda_nA_n\sin\lambda_n t+\lambda_nB_n\cos\lambda_n t) \sin\frac{n\pi x}{L} $. Let $t=0$ to obtain from the initial condition $u_t(0,x)=g(x)$ the equation $g(x) = \sum_{n=1}^\infty \lambda_nB_n \sin\frac{n\pi x}{L} $, the Fourier sine series of $g(x)$.  From the Euler formulas we obtain $\lambda_n B_n = \frac{2}{L}\int_0^L g(x)\sin\frac{n\pi x}{L}dx$, or $B_n = \frac{2}{n c\pi}\int_0^L g(x)\sin\frac{n\pi x}{L}dx$.  We now have a solution $u(t,x) =  \sum_{n=1}^\infty (A_n\cos\lambda_n t+B_n\sin\lambda_n t) \sin\frac{n\pi x}{L} $, where $\lambda_n = \frac{n\pi}{L}c$ and $A_n$ and $B_n$ are obtained from Euler formulas. This solution is only valid under certain circumstances, which we will not take time to discuss in detail here. A course in analysis would provide enough details.

\subsection{Summary}
Notice how we separated the PDE, solved individual ODEs, and then used superposition and Fourier series to come up with a complete solution.  This technique is a standard tool which you should become familiar with. You will be able to practice it one more time as you solve the heat equation in the next section.

When the initial velocity $g(x)$ is zero, the solution $u(t,x) =  \sum_{n=1}^\infty (A_n\cos\lambda_n t+B_n\sin\lambda_n t) \sin\frac{n\pi x}{L} $ can be written in a much nicer manner.  Since $g(x)=0$, we have $B_n=0$. Using the trig identity $\cos(A)\sin(B)=\frac{1}{2}(\sin(A+B)+\sin(A-B))$, we write   $$\sum_{n=1}^\infty A_n\cos\lambda_n t \sin\frac{n\pi x}{L}=\frac{1}{2}\left(\sum_{n=1}^\infty A_n\sin \frac{n\pi}{L}(x+ct)+\sum_{n=1}^\infty A_n\sin \frac{n\pi}{L}(x-ct)\right)=\frac{1}{2}\left(f^*(x+ct)+f^*(x-ct)\right),$$ where $f^*$ is the odd periodic extension of $f$.  So a solution of the wave equation when the initial velocity is zero is found by simply creating the odd periodic extension of $f$, and then moving the wave left and right where $c$ determines the speed at which the waves travel, and then halving the sum of these two waves. 

\section{Solution of the heat equation}
The one dimensional heat equation is the PDE $u_t = c^2 u_{xx}$.  It models the temperature of a one dimensional object at any time $t$.  There are two problems we will solve.  First, suppose the rod is $L$ units long, is kept at temperature 0 at both endpoints $u(t,0)=u(t,L)=0$, and has initial temperature $u(0,t)=f(x)$ for $0\leq x\leq L$. Second, suppose the rod has insulated endpoints (no heat can escape through the endpoints) and has initial temperature $u(0,x)=f(x)$.  Experiments show that the boundary conditions for an insulated rod are $u_x(t,0)=0=u_x(t,L)$.  As hints for solutions, your solution should involve a Fourier sine series for the first problem, and a Fourier cosine series for the second one.  I will provide solutions for these problems online.   

